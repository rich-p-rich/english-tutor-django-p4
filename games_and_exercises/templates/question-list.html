{% extends 'base.html' %}

{% block content %}
<h1>{{ section.title }} Questions</h1>
<form method="post">
    {% csrf_token %}
    <ol>
        {% for question in questions %}
        <li>
            <p>{{ question.question_text }}</p>
            {% for choice in question.choices.all %}
            <div>
                <input type="radio" name="{{ question.id }}" value="{{ choice.id }}" id="choice{{ choice.id }}">
                <label for="choice{{ choice.id }}">{{ choice.choice_text }}</label>
            </div>
            {% endfor %}
        </li>
        {% endfor %}
    </ol>
    <button type="submit">Submit</button>
</form>

{% if user_answers %}
    <h2>Results</h2>
    <ol>
        {% for question in questions %}
        <li>
            <p>{{ question.question_text }}</p>
            {% if user_answers|dict_has_key:question.id %}
                {% if user_answers|dict_get:question.id.correct %}
                <p style="color: green;">Correct! You selected: {{ user_answers|dict_get:question.id.selected.choice_text }}</p>
                {% else %}
                <p style="color: red;">Incorrect. You selected: {{ user_answers|dict_get:question.id.selected.choice_text }}. The correct answer is {{ question.correct_choice.choice_text }}.</p>
                {% endif %}
            {% endif %}
        </li>
        {% endfor %}
    </ol>
{% endif %}
{% endblock %}
